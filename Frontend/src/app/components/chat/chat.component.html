<button type="button" [ngClass]="{ hidden: chatBoxToggle }" (click)="openChatBox()" class="btn btn-outline-dark icon-bottom-right">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-right-dots" viewBox="0 0 16 16">
        <path d="M2 1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h9.586a2 2 0 0 1 1.414.586l2 2V2a1 1 0 0 0-1-1H2zm12-1a2 2 0 0 1 2 2v12.793a.5.5 0 0 1-.854.353l-2.853-2.853a1 1 0 0 0-.707-.293H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12z"/>
        <path d="M5 6a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
    </svg>
</button>

<div *ngIf="chatBoxToggle">

<div class="outer-box"> 
        <div *ngIf="loggedInUserName !== ''">
          <div class="portlet portlet-default">
              <div class="portlet-heading">
                  <div class="portlet-title py-2">
                      <h4 class="d-inline-flex"><i class="fa fa-circle text-green"></i> {{username}}</h4>
                      <div class="d-inline-flex ml-2"><p><small><em>Users currently online: <span style="color: limegreen;">{{ totalusers.total}}</span></em></small></p></div>
                  </div>
                  <div class="portlet-widgets">
                        <span class="divider"></span>
                        <a (click)="openChatBox()" class="btn" style="color:white">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-x" viewBox="0 0 16 16">
                                <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                            </svg>
                        </a>
                 </div>
                  <div class="clearfix"></div>
              </div>
              <div id="chat">
              <div>
                <div class="portlet-body" style="overflow-y: auto; width: auto; height: 300px;">
                    <div class="row" *ngFor="let message of messages">
                        <div [ngClass]="{ self: message.self }" class="col-lg-12 px-2">
                            <div class="media">
                                <a class="pull-left" href="#">
                                    <img class="media-object img-circle img-chat" src="https://bootdey.com/img/Content/avatar/avatar1.png" alt="">
                                </a>
                                <div style="padding: 5px;" class="media-body">
                                    <h6 class="media-heading">{{message.user}}
                                        <span class="small pull-right">{{message.date | date:'MM/dd/yyyy h:mm:ss a'}}</span>
                                    </h6>
                                    <p><small>{{message.message}}</small></p>
                                </div>
                            </div>
                        </div>
                        <hr/>
                    </div>
                </div>
             </div>
                <div class="portlet-footer">
                    <form role="form">
                        <div class="form-group">
                            <textarea name="message" [(ngModel)]="message" class="form-control" placeholder="Enter message..."></textarea>
                        </div>
                        <div class="form-group">
                            <button type="button" (click)="sendMessage()" class="btn btn-dark pull-right">Send</button>
                        </div>
                    </form>
                </div>
            </div>
            </div>
        </div>
            <div class="anonymousUser" *ngIf="loggedInUserName == ''">
                <div class="portlet portlet-default">
                  <div class="portlet-footer">
                      <form role="form">
                          <div class="form-group">
                              <input  [(ngModel)]="username" name = "username" type ="text" class="form-control" placeholder="Enter a username to chat with..."/>
                          </div>
                          <div class="form-group">
                              <button (click)="loginUser()" type="button" class="btn btn-dark pull-right">Start Chatting</button>
                              <button (click)="openChatBox()" type="button" class="btn" style="color:red">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x" viewBox="0 0 16 16">
                                    <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                                  </svg>
                              </button>
                          </div>
                      </form>
                  </div>
                </div>
            </div>      
</div>